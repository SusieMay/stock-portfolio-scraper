<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio Giełdowe</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <style>
    .modal-background {
      background-color: rgba(0, 0, 0, 0.5);
    }

    .stock-row {
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .stock-row:hover {
      background-color: rgba(59, 130, 246, 0.1);
    }

    .error-boundary {
      color: red;
      background-color: #ffeeee;
      padding: 10px;
      margin: 10px;
      border: 1px solid red;
      border-radius: 5px;
    }

    .tab {
      cursor: pointer;
      padding: 0.75rem 1.5rem;
      border-bottom: 2px solid transparent;
      font-weight: 500;
      transition: all 0.2s;
    }

    .tab.active {
      border-bottom-color: #2563eb;
      color: #2563eb;
    }

    .tab:hover:not(.active) {
      border-bottom-color: #d1d5db;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;

    // Funkcje pomocnicze do bezpiecznego formatowania liczb
    const safeToFixed = (value, decimals = 2) => {
      // Konwertuj wartość na liczbę
      const num = Number(value);
      // Sprawdź czy to faktycznie liczba i czy nie jest NaN
      if (!isNaN(num) && isFinite(num)) {
        return num.toFixed(decimals);
      }
      // W przypadku błędu zwróć domyślną wartość
      return '0.00';
    };

    const formatNumber = (value) => {
      const num = Number(value);
      if (!isNaN(num) && isFinite(num)) {
        return num.toLocaleString();
      }
      return '0';
    };

    // Komponent do obsługi błędów
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { hasError: false, error: null };
      }

      static getDerivedStateFromError(error) {
        return { hasError: true, error };
      }

      componentDidCatch(error, errorInfo) {
        console.error("Error caught by boundary:", error, errorInfo);
      }

      render() {
        if (this.state.hasError) {
          return (
            <div className="error-boundary">
              <h3 className="text-xl font-bold mb-2">Wystąpił błąd w aplikacji</h3>
              <p className="mb-4">{this.state.error && this.state.error.toString()}</p>
              <button
                onClick={() => this.setState({ hasError: false })}
                className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
              >
                Spróbuj ponownie
              </button>
            </div>
          );
        }

        return this.props.children;
      }
    }

    // Główny komponent aplikacji
    function App() {
      const [indexes, setIndexes] = useState([]);
      const [selectedIndex, setSelectedIndex] = useState(null);
      const [allStocks, setAllStocks] = useState([]);
      const [displayedStocks, setDisplayedStocks] = useState([]);
      const [portfolioStocks, setPortfolioStocks] = useState([]);
      const [loading, setLoading] = useState(false);
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedSector, setSelectedSector] = useState('');
      const [sectors, setSectors] = useState([]);
      const [sortConfig, setSortConfig] = useState({ key: 'name', direction: 'asc' });
      const [selectedStock, setSelectedStock] = useState(null);
      const [showAddStockModal, setShowAddStockModal] = useState(false);
      const [portfolioValue, setPortfolioValue] = useState(0);
      const [portfolioChange, setPortfolioChange] = useState(0);
      const [viewMode, setViewMode] = useState('portfolio'); // 'portfolio' lub 'browse'
      const [showTickerManagement, setShowTickerManagement] = useState(false);
      const [error, setError] = useState(null);

      // Pobierz dane o indeksach
      useEffect(() => {
        const fetchIndexes = async () => {
          try {
            const response = await fetch('http://localhost:5000/api/indexes');
            const data = await response.json();
            setIndexes(data);
          } catch (error) {
            console.error('Błąd pobierania indeksów:', error);
            setError("Nie udało się pobrać danych indeksów. Sprawdź połączenie z serwerem.");
            setIndexes([]);
          }
        };

        fetchIndexes();
      }, []);

      // Funkcja odświeżania danych po dodaniu/usunięciu tickera
      const refreshData = useCallback(async () => {
        setLoading(true);
        try {
          const response = await fetch('http://localhost:5000/api/stocks');
          const data = await response.json();
          setAllStocks(data);

          // Filtrowanie według aktualnych ustawień
          let filtered = [...data];

          if (selectedIndex) {
            filtered = filtered.filter(stock => stock.index_name === selectedIndex);
          }

          if (searchTerm) {
            const lowerSearchTerm = searchTerm.toLowerCase();
            filtered = filtered.filter(stock =>
              stock.name.toLowerCase().includes(lowerSearchTerm) ||
              stock.ticker.toLowerCase().includes(lowerSearchTerm)
            );
          }

          if (selectedSector) {
            filtered = filtered.filter(stock => stock.sector === selectedSector);
          }

          setDisplayedStocks(filtered);

          // Odświeżanie portfolio z nowymi cenami
          const storedPortfolio = localStorage.getItem('portfolioStocks');
          if (storedPortfolio) {
            const parsedPortfolio = JSON.parse(storedPortfolio);
            const updatedPortfolio = parsedPortfolio.map(portfolioItem => {
              const currentStock = data.find(s => s.ticker === portfolioItem.ticker);
              if (currentStock) {
                return {
                  ...portfolioItem,
                  currentPrice: Number(currentStock.price),
                  currentValue: Number(currentStock.price) * Number(portfolioItem.quantity),
                  change: ((Number(currentStock.price) - Number(portfolioItem.buyPrice)) / Number(portfolioItem.buyPrice)) * 100,
                  profit: (Number(currentStock.price) - Number(portfolioItem.buyPrice)) * Number(portfolioItem.quantity)
                };
              }
              return portfolioItem;
            });
            setPortfolioStocks(updatedPortfolio);
            updatePortfolioStats(updatedPortfolio);
          }
          setError(null);
        } catch (error) {
          console.error('Błąd odświeżania danych:', error);
          setError("Nie udało się odświeżyć danych. Sprawdź połączenie z serwerem.");
        } finally {
          setLoading(false);
        }
      }, [selectedIndex, searchTerm, selectedSector]);

      // Pobierz dane o akcjach
      useEffect(() => {
        const fetchStocks = async () => {
          setLoading(true);
          try {
            const response = await fetch('http://localhost:5000/api/stocks');
            const data = await response.json();
            setAllStocks(data);
            setDisplayedStocks(data);

            // Wyodrębnij wszystkie sektory
            const uniqueSectors = [...new Set(data.map(stock => stock.sector))];
            setSectors(uniqueSectors);

            // Inicjalizacja portfolio z localStorage
            const storedPortfolio = localStorage.getItem('portfolioStocks');
            if (storedPortfolio) {
              const parsedPortfolio = JSON.parse(storedPortfolio);
              // Uzupełnij dane portfolio najnowszymi cenami
              const updatedPortfolio = parsedPortfolio.map(portfolioItem => {
                const currentStock = data.find(s => s.ticker === portfolioItem.ticker);
                if (currentStock) {
                  return {
                    ...portfolioItem,
                    currentPrice: Number(currentStock.price),
                    currentValue: Number(currentStock.price) * Number(portfolioItem.quantity),
                    change: ((Number(currentStock.price) - Number(portfolioItem.buyPrice)) / Number(portfolioItem.buyPrice)) * 100,
                    profit: (Number(currentStock.price) - Number(portfolioItem.buyPrice)) * Number(portfolioItem.quantity)
                  };
                }
                return portfolioItem;
              });
              setPortfolioStocks(updatedPortfolio);
              updatePortfolioStats(updatedPortfolio);
            }
            setError(null);
          } catch (error) {
            console.error('Błąd pobierania akcji:', error);
            setError("Nie udało się pobrać danych akcji. Sprawdź połączenie z serwerem.");
            setAllStocks([]);
            setDisplayedStocks([]);
            setSectors([]);
          } finally {
            setLoading(false);
          }
        };

        fetchStocks();
      }, []);

      // Oblicz wartość i zmianę portfolio
      const updatePortfolioStats = (portfolio) => {
        const totalValue = portfolio.reduce((sum, stock) => sum + Number(stock.currentValue), 0);
        const totalInvestment = portfolio.reduce((sum, stock) => sum + (Number(stock.buyPrice) * Number(stock.quantity)), 0);
        const totalChange = totalInvestment > 0 ? ((totalValue - totalInvestment) / totalInvestment) * 100 : 0;

        setPortfolioValue(totalValue);
        setPortfolioChange(totalChange);
      };

      // Obsługa dodawania akcji do portfolio
      const handleAddToPortfolio = (stockData) => {
        const { ticker, quantity, buyPrice, buyDate } = stockData;
        const stockInfo = allStocks.find(s => s.ticker === ticker);

        if (stockInfo) {
          const price = Number(stockInfo.price);
          const qty = Number(quantity);
          const buy = Number(buyPrice);

          const newPortfolioItem = {
            id: Date.now(),
            ticker: ticker,
            name: stockInfo.name,
            quantity: qty,
            buyPrice: buy,
            buyDate: buyDate,
            currentPrice: price,
            currentValue: price * qty,
            change: ((price - buy) / buy) * 100,
            profit: (price - buy) * qty
          };

          const updatedPortfolio = [...portfolioStocks, newPortfolioItem];
          setPortfolioStocks(updatedPortfolio);
          updatePortfolioStats(updatedPortfolio);
          localStorage.setItem('portfolioStocks', JSON.stringify(updatedPortfolio));
        }

        setShowAddStockModal(false);
      };

      // Usuwanie akcji z portfolio
      const handleRemoveFromPortfolio = (stockId) => {
        if (confirm('Czy na pewno chcesz usunąć tę pozycję z portfolio?')) {
          const updatedPortfolio = portfolioStocks.filter(stock => stock.id !== stockId);
          setPortfolioStocks(updatedPortfolio);
          updatePortfolioStats(updatedPortfolio);
          localStorage.setItem('portfolioStocks', JSON.stringify(updatedPortfolio));
        }
      };

      // Obsługa kliknięcia w akcję
      const handleStockClick = (ticker) => {
        setSelectedStock(ticker);
      };

      // Obsługa sortowania
      const handleSort = (key) => {
        let direction = 'asc';
        if (sortConfig.key === key && sortConfig.direction === 'asc') {
          direction = 'desc';
        }

        setSortConfig({ key, direction });

        const sortedStocks = [...displayedStocks].sort((a, b) => {
          const aValue = a[key] !== undefined ? a[key] : '';
          const bValue = b[key] !== undefined ? b[key] : '';

          if (aValue < bValue) return direction === 'asc' ? -1 : 1;
          if (aValue > bValue) return direction === 'asc' ? 1 : -1;
          return 0;
        });

        setDisplayedStocks(sortedStocks);
      };

      // Obsługa zmiany indeksu
      const handleIndexChange = (indexName) => {
        setSelectedIndex(selectedIndex === indexName ? null : indexName);
        if (viewMode !== 'browse') {
          setViewMode('browse');
        }
      };

      // Filtrowanie akcji
      useEffect(() => {
        if (allStocks.length > 0) {
          let filtered = [...allStocks];

          // Filtrowanie według indeksu
          if (selectedIndex) {
            filtered = filtered.filter(stock => stock.index_name === selectedIndex);
          }

          // Filtrowanie według wyszukiwania
          if (searchTerm) {
            const lowerSearchTerm = searchTerm.toLowerCase();
            filtered = filtered.filter(stock =>
              stock.name?.toLowerCase().includes(lowerSearchTerm) ||
              stock.ticker?.toLowerCase().includes(lowerSearchTerm)
            );
          }

          // Filtrowanie według sektora
          if (selectedSector) {
            filtered = filtered.filter(stock => stock.sector === selectedSector);
          }

          // Sortowanie
          filtered.sort((a, b) => {
            const aValue = a[sortConfig.key] !== undefined ? a[sortConfig.key] : '';
            const bValue = b[sortConfig.key] !== undefined ? b[sortConfig.key] : '';

            if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
            if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
            return 0;
          });

          setDisplayedStocks(filtered);
        }
      }, [selectedIndex, searchTerm, selectedSector, sortConfig, allStocks]);

      // Renderowanie błędu
      if (error) {
        return (
          <div className="container mx-auto px-4 py-8">
            <div className="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded">
              <h2 className="text-xl font-bold mb-2">Błąd połączenia</h2>
              <p>{error}</p>
              <button
                onClick={() => window.location.reload()}
                className="mt-4 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"
              >
                Odśwież stronę
              </button>
            </div>
          </div>
        );
      }

      // Renderowanie
      return (
        <div className="container mx-auto px-4 py-8">
          {/* Nagłówek */}
          <div className="flex flex-col md:flex-row justify-between items-center mb-8">
            <h1 className="text-3xl font-bold text-gray-800 mb-4 md:mb-0">
              Portfolio Giełdowe
            </h1>

            <div className="flex flex-wrap gap-3 md:space-x-4">
              <button
                className="px-4 py-2 rounded-md font-medium bg-purple-600 hover:bg-purple-700 text-white"
                onClick={() => setShowTickerManagement(true)}
              >
                <i className="fas fa-cog mr-2"></i>
                Zarządzanie tickerami
              </button>
              <button
                className={`px-4 py-2 rounded-md font-medium ${viewMode === 'portfolio' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                onClick={() => setViewMode('portfolio')}
              >
                Moje Portfolio
              </button>
              <button
                className={`px-4 py-2 rounded-md font-medium ${viewMode === 'browse' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                onClick={() => setViewMode('browse')}
              >
                Przeglądaj Akcje
              </button>
            </div>
          </div>

          {/* Zakładki indeksów */}
          <div className="mb-8 border-b border-gray-200">
            <div className="flex overflow-x-auto">
              <div
                className={`tab ${selectedIndex === 'WIG' ? 'active' : ''}`}
                onClick={() => handleIndexChange('WIG')}
              >
                WIG
              </div>
              <div
                className={`tab ${selectedIndex === 'WIG20' ? 'active' : ''}`}
                onClick={() => handleIndexChange('WIG20')}
              >
                WIG20
              </div>
              <div
                className={`tab ${selectedIndex === 'mWIG40' ? 'active' : ''}`}
                onClick={() => handleIndexChange('mWIG40')}
              >
                mWIG40
              </div>
              <div
                className={`tab ${selectedIndex === 'sWIG80' ? 'active' : ''}`}
                onClick={() => handleIndexChange('sWIG80')}
              >
                sWIG80
              </div>
            </div>
          </div>

          {/* Sekcja wartości portfolio */}
          {viewMode === 'portfolio' && (
            <div className="bg-white rounded-lg shadow p-6 mb-8">
              <div className="flex flex-col md:flex-row justify-between items-center mb-4">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">Wartość Twojego Portfolio</h2>
                  <p className="text-3xl font-bold mt-2">{formatNumber(portfolioValue)} PLN</p>
                  <p className={`text-xl font-medium ${Number(portfolioChange) >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                    {Number(portfolioChange) > 0 ? '+' : ''}{safeToFixed(portfolioChange)}%
                  </p>
                </div>
                <button
                  className="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-md font-medium flex items-center mt-4 md:mt-0"
                  onClick={() => setShowAddStockModal(true)}
                >
                  <i className="fas fa-plus mr-2"></i>
                  Dodaj Akcję
                </button>
              </div>
            </div>
          )}

          {/* Filtrowanie i wyszukiwanie */}
          <div className="bg-white rounded-lg shadow p-6 mb-6">
            <div className="flex flex-col md:flex-row md:items-center justify-between mb-4">
              <h2 className="text-xl font-bold text-gray-800 mb-4 md:mb-0">
                {viewMode === 'portfolio' ? 'Moje Akcje' : selectedIndex ? `Akcje - ${selectedIndex}` : 'Wszystkie Akcje'}
              </h2>

              {viewMode === 'browse' && (
                <div className="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
                  <div className="relative">
                    <input
                      type="text"
                      placeholder="Szukaj akcji..."
                      className="border border-gray-300 rounded-md px-4 py-2 w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                    />
                    <i className="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                  </div>

                  <select
                    className="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value={selectedSector}
                    onChange={(e) => setSelectedSector(e.target.value)}
                  >
                    <option value="">Wszystkie sektory</option>
                    {sectors.map(sector => (
                      <option key={sector} value={sector}>{sector}</option>
                    ))}
                  </select>
                </div>
              )}
            </div>

            {/* Lista akcji w portfolio */}
            {viewMode === 'portfolio' && (
              <div className="overflow-x-auto rounded-lg shadow">
                {portfolioStocks.length === 0 ? (
                  <div className="bg-white p-8 text-center">
                    <p className="text-gray-600">Twoje portfolio jest puste. Dodaj akcje, aby rozpocząć śledzenie.</p>
                    <button
                      className="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md"
                      onClick={() => setShowAddStockModal(true)}
                    >
                      Dodaj Pierwszą Akcję
                    </button>
                  </div>
                ) : (
                  <table className="min-w-full bg-white">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Nazwa</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Ticker</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Ilość</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Cena zakupu</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Aktualna cena</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Wartość</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Zmiana %</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Zysk/Strata</th>
                        <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Akcje</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-200">
                      {portfolioStocks.map(stock => (
                        <tr key={stock.id} className="stock-row hover:bg-blue-50">
                          <td className="py-4 px-4 text-sm font-medium text-gray-900">{stock.name}</td>
                          <td className="py-4 px-4 text-sm font-medium">{stock.ticker}</td>
                          <td className="py-4 px-4 text-sm">{stock.quantity}</td>
                          <td className="py-4 px-4 text-sm">{safeToFixed(stock.buyPrice)} PLN</td>
                          <td className="py-4 px-4 text-sm">{safeToFixed(stock.currentPrice)} PLN</td>
                          <td className="py-4 px-4 text-sm font-medium">{safeToFixed(stock.currentValue)} PLN</td>
                          <td className={`py-4 px-4 text-sm font-medium ${Number(stock.change) >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                            {Number(stock.change) > 0 ? '+' : ''}{safeToFixed(stock.change)}%
                          </td>
                          <td className={`py-4 px-4 text-sm font-medium ${Number(stock.profit) >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                            {Number(stock.profit) > 0 ? '+' : ''}{safeToFixed(stock.profit)} PLN
                          </td>
                          <td className="py-4 px-4 text-sm">
                            <button
                              className="text-red-600 hover:text-red-800"
                              onClick={() => handleRemoveFromPortfolio(stock.id)}
                            >
                              <i className="fas fa-trash"></i>
                            </button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                )}
              </div>
            )}

            {/* Lista wszystkich akcji */}
            {viewMode === 'browse' && (
              <StocksTable
                stocks={displayedStocks}
                loading={loading}
                onSortChange={handleSort}
                sortConfig={sortConfig}
                onStockClick={handleStockClick}
              />
            )}
          </div>

          {/* Modalne okno dodawania akcji */}
          {showAddStockModal && (
            <AddStockModal
              stocks={allStocks}
              onClose={() => setShowAddStockModal(false)}
              onAdd={handleAddToPortfolio}
            />
          )}

          {/* Modalne okno szczegółów akcji */}
          {selectedStock && (
            <StockDetailsModal
              ticker={selectedStock}
              onClose={() => setSelectedStock(null)}
              onAddToPortfolio={() => {
                setShowAddStockModal(true);
                setSelectedStock(null);
              }}
            />
          )}

          {/* Modalne okno zarządzania tickerami */}
          {showTickerManagement && (
            <TickerManagementModal
              onClose={() => setShowTickerManagement(false)}
              onRefresh={refreshData}
            />
          )}
        </div>
      );
    }

    // --- Pozostałe komponenty pozostają bez zmian ---

    // Komponent nagłówka kolumny z sortowaniem
    function SortableHeader({ column, label, sortConfig, onSortChange }) {
      const getIcon = () => {
        if (sortConfig.key === column) {
          return sortConfig.direction === 'asc'
            ? <i className="fas fa-sort-up ml-1"></i>
            : <i className="fas fa-sort-down ml-1"></i>;
        }
        return <i className="fas fa-sort ml-1 text-gray-300"></i>;
      };

      return (
        <th
          className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer hover:bg-gray-200"
          onClick={() => onSortChange(column)}
        >
          <div className="flex items-center">
            {label}
            {getIcon()}
          </div>
        </th>
      );
    }

    // Komponent wiersza akcji
    function StockRow({ stock, onClick }) {
      return (
        <tr className="stock-row hover:bg-blue-50" onClick={() => onClick(stock.ticker)}>
          <td className="py-4 px-4 text-sm font-medium text-gray-900">{stock.name}</td>
          <td className="py-4 px-4 text-sm font-medium">{stock.ticker}</td>
          <td className="py-4 px-4 text-sm">{safeToFixed(stock.price)}</td>
          <td className={`py-4 px-4 text-sm font-medium ${Number(stock.change_percent) >= 0 ? 'text-green-600' : 'text-red-600'}`}>
            {Number(stock.change_percent) > 0 ? '+' : ''}{safeToFixed(stock.change_percent)}%
          </td>
          <td className="py-4 px-4 text-sm">{formatNumber(stock.volume)}</td>
          <td className="py-4 px-4 text-sm">{safeToFixed(Number(stock.market_cap) / 1000000)} mln</td>
          <td className="py-4 px-4 text-sm">{stock.index_name}</td>
          <td className="py-4 px-4 text-sm">{stock.sector}</td>
        </tr>
      );
    }

    // Komponent tabeli akcji
    function StocksTable({ stocks, loading, onSortChange, sortConfig, onStockClick }) {
      if (loading) {
        return (
          <div className="flex justify-center py-12">
            <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
          </div>
        );
      }

      if (!stocks || stocks.length === 0) {
        return (
          <div className="text-center py-8 text-gray-500">
            Brak danych do wyświetlenia
          </div>
        );
      }

      return (
        <div className="overflow-x-auto rounded-lg shadow">
          <table className="min-w-full bg-white">
            <thead className="bg-gray-100">
              <tr>
                <SortableHeader column="name" label="Nazwa" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="ticker" label="Ticker" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="price" label="Cena (PLN)" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="change_percent" label="Zmiana %" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="volume" label="Wolumen" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="market_cap" label="Kapitalizacja (PLN)" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="index_name" label="Indeks" sortConfig={sortConfig} onSortChange={onSortChange} />
                <SortableHeader column="sector" label="Sektor" sortConfig={sortConfig} onSortChange={onSortChange} />
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-200">
              {stocks.map(stock => (
                <StockRow
                  key={stock.id}
                  stock={stock}
                  onClick={onStockClick}
                />
              ))}
            </tbody>
          </table>
        </div>
      );
    }

    // Komponent modal szczegółów akcji
    function StockDetailsModal({ ticker, onClose, onAddToPortfolio }) {
      const [loading, setLoading] = useState(true);
      const [stockDetails, setStockDetails] = useState(null);
      const [error, setError] = useState(null);
      const modalRef = useRef(null);
      const chartRef = useRef(null);
      const chartInstance = useRef(null);

      useEffect(() => {
        // Pobieramy szczegółowe dane o akcji
        const fetchStockDetails = async () => {
          setLoading(true);
          try {
            const response = await fetch(`http://localhost:5000/api/stock-details/${ticker}`);
            if (!response.ok) {
              throw new Error('Problem z pobraniem danych');
            }
            const data = await response.json();
            setStockDetails(data);
            setError(null);
          } catch (err) {
            console.error('Błąd pobierania szczegółów:', err);
            setError('Nie udało się pobrać szczegółowych danych o akcji. Sprawdź połączenie z serwerem.');
          } finally {
            setLoading(false);
          }
        };

        fetchStockDetails();

        // Obsługa kliknięcia poza modalem
        const handleClickOutside = (event) => {
          if (modalRef.current && !modalRef.current.contains(event.target)) {
            onClose();
          }
        };

        document.addEventListener('mousedown', handleClickOutside);
        return () => {
          document.removeEventListener('mousedown', handleClickOutside);
        };
      }, [ticker, onClose]);

      // Tworzymy wykres po załadowaniu danych
      useEffect(() => {
        if (stockDetails && stockDetails.historical_data && stockDetails.historical_data.length > 0 && chartRef.current) {
          // Przygotowujemy dane
          const labels = stockDetails.historical_data.map(data => data.date);
          const prices = stockDetails.historical_data.map(data => Number(data.close_price));

          // Niszczymy poprzedni wykres, jeśli istnieje
          if (chartInstance.current) {
            chartInstance.current.destroy();
          }

          // Tworzymy nowy wykres
          const ctx = chartRef.current.getContext('2d');
          chartInstance.current = new Chart(ctx, {
            type: 'line',
            data: {
              labels: labels,
              datasets: [{
                label: 'Cena zamknięcia (PLN)',
                data: prices,
                backgroundColor: 'rgba(59, 130, 246, 0.2)',
                borderColor: 'rgba(59, 130, 246, 1)',
                borderWidth: 2,
                pointRadius: 3,
                tension: 0.1
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: true,
                  position: 'top',
                },
                tooltip: {
                  mode: 'index',
                  intersect: false,
                }
              },
              scales: {
                x: {
                  ticks: {
                    maxRotation: 45,
                    minRotation: 45
                  }
                },
                y: {
                  beginAtZero: false
                }
              }
            }
          });
        }

        return () => {
          if (chartInstance.current) {
            chartInstance.current.destroy();
          }
        };
      }, [stockDetails]);

      // Jeśli ładujemy dane
      if (loading) {
        return (
          <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
            <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-4xl h-auto max-h-[90vh] overflow-auto">
              <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"></div>
              <p className="text-center mt-4 text-gray-600">Ładowanie szczegółów...</p>
            </div>
          </div>
        );
      }

      // Jeśli wystąpił błąd
      if (error) {
        return (
          <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
            <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-4xl">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-red-600">Błąd</h2>
                <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                  <i className="fas fa-times text-xl"></i>
                </button>
              </div>
              <p className="text-gray-700">{error}</p>
              <div className="mt-6 flex justify-end">
                <button onClick={onClose} className="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded">
                  Zamknij
                </button>
              </div>
            </div>
          </div>
        );
      }

      // Jeśli nie ma danych
      if (!stockDetails || !stockDetails.stock) {
        return (
          <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
            <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-4xl">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Brak danych</h2>
                <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                  <i className="fas fa-times text-xl"></i>
                </button>
              </div>
              <p className="text-gray-700">Nie znaleziono szczegółowych danych dla wybranej akcji.</p>
              <div className="mt-6 flex justify-end">
                <button onClick={onClose} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
                  Zamknij
                </button>
              </div>
            </div>
          </div>
        );
      }

      const stock = stockDetails.stock;
      const changeColor = Number(stock.change_percent) >= 0 ? 'text-green-600' : 'text-red-600';

      return (
        <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
          <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-4xl h-auto max-h-[90vh] overflow-auto">
            <div className="flex justify-between items-center mb-6">
              <div>
                <h2 className="text-2xl font-bold text-gray-800">{stock.name}</h2>
                <p className="text-gray-600">{stock.ticker} | {stock.sector}</p>
              </div>
              <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                <i className="fas fa-times text-xl"></i>
              </button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">Cena</h3>
                <p className="text-2xl font-bold">{safeToFixed(stock.price)} PLN</p>
                <p className={`text-sm font-medium ${changeColor}`}>
                  {Number(stock.change_percent) > 0 ? '+' : ''}{safeToFixed(stock.change_percent)}%
                </p>
              </div>

              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">Kapitalizacja</h3>
                <p className="text-2xl font-bold">{safeToFixed(Number(stock.market_cap) / 1000000000)} mld</p>
                <p className="text-sm text-gray-600">PLN</p>
              </div>

              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">Wolumen</h3>
                <p className="text-2xl font-bold">{formatNumber(stock.volume)}</p>
                <p className="text-sm text-gray-600">akcji</p>
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">C/Z (P/E)</h3>
                <p className="text-2xl font-bold">{safeToFixed(stock.pe_ratio)}</p>
              </div>

              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">Dywidenda</h3>
                <p className="text-2xl font-bold">{safeToFixed(stock.dividend_yield)}%</p>
              </div>

              <div className="bg-gray-50 p-4 rounded-lg">
                <h3 className="text-sm text-gray-500 uppercase">EPS</h3>
                <p className="text-2xl font-bold">{safeToFixed(stock.eps)} PLN</p>
              </div>
            </div>

            <div className="mb-8">
              <h3 className="text-xl font-bold mb-4">Wykres ceny</h3>
              <div className="h-[300px]">
                <canvas ref={chartRef}></canvas>
              </div>
            </div>

            <div className="mb-8">
              <h3 className="text-xl font-bold mb-4">O spółce</h3>
              <p className="text-gray-700">{stock.description}</p>
            </div>

            <div className="flex justify-end">
              <button
                onClick={onAddToPortfolio}
                className="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-md font-medium flex items-center"
              >
                <i className="fas fa-plus mr-2"></i>
                Dodaj do Portfolio
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Komponent modalu dodawania akcji
    function AddStockModal({ stocks, onClose, onAdd }) {
      const [selectedStock, setSelectedStock] = useState('');
      const [quantity, setQuantity] = useState('');
      const [buyPrice, setBuyPrice] = useState('');
      const [buyDate, setBuyDate] = useState(new Date().toISOString().split('T')[0]);
      const [searchTerm, setSearchTerm] = useState('');
      const modalRef = useRef(null);

      const filteredStocks = stocks.filter(stock =>
        stock.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||
        stock.ticker?.toLowerCase().includes(searchTerm.toLowerCase())
      );

      // Obsługa wyboru akcji
      const handleSelectStock = (ticker) => {
        setSelectedStock(ticker);
        const stock = stocks.find(s => s.ticker === ticker);
        if (stock) {
          setBuyPrice(safeToFixed(stock.price));
        }
      };

      // Obsługa dodawania akcji
      const handleSubmit = (e) => {
        e.preventDefault();

        if (!selectedStock || !quantity || !buyPrice || !buyDate) {
          alert('Proszę wypełnić wszystkie pola formularza.');
          return;
        }

        onAdd({
          ticker: selectedStock,
          quantity,
          buyPrice,
          buyDate
        });
      };

      // Obsługa kliknięcia poza modalem
      useEffect(() => {
        const handleClickOutside = (event) => {
          if (modalRef.current && !modalRef.current.contains(event.target)) {
            onClose();
          }
        };

        document.addEventListener('mousedown', handleClickOutside);
        return () => {
          document.removeEventListener('mousedown', handleClickOutside);
        };
      }, [onClose]);

      return (
        <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
          <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-2xl">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-2xl font-bold text-gray-800">Dodaj akcję do portfolio</h2>
              <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                <i className="fas fa-times text-xl"></i>
              </button>
            </div>

            <form onSubmit={handleSubmit}>
              <div className="mb-6">
                <label className="block text-gray-700 font-medium mb-2">Wybierz akcję</label>
                <div className="relative mb-4">
                  <input
                    type="text"
                    placeholder="Szukaj akcji..."
                    className="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                  />
                  <i className="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                </div>

                <div className="max-h-48 overflow-y-auto border border-gray-300 rounded-md mb-4">
                  {filteredStocks.length > 0 ? (
                    <ul className="divide-y divide-gray-200">
                      {filteredStocks.map(stock => (
                        <li
                          key={stock.id}
                          className={`py-2 px-4 cursor-pointer hover:bg-blue-50 ${selectedStock === stock.ticker ? 'bg-blue-100' : ''}`}
                          onClick={() => handleSelectStock(stock.ticker)}
                        >
                          <div className="flex justify-between items-center">
                            <div>
                              <p className="font-medium">{stock.name}</p>
                              <p className="text-sm text-gray-600">{stock.ticker}</p>
                            </div>
                            <p className="font-medium">{safeToFixed(stock.price)} PLN</p>
                          </div>
                        </li>
                      ))}
                    </ul>
                  ) : (
                    <p className="py-4 px-4 text-gray-500 text-center">Brak wyników</p>
                  )}
                </div>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div>
                  <label className="block text-gray-700 font-medium mb-2">Ilość</label>
                  <input
                    type="number"
                    min="0.01"
                    step="0.01"
                    className="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value={quantity}
                    onChange={(e) => setQuantity(e.target.value)}
                    required
                  />
                </div>

                <div>
                  <label className="block text-gray-700 font-medium mb-2">Cena zakupu (PLN)</label>
                  <input
                    type="number"
                    min="0.01"
                    step="0.01"
                    className="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value={buyPrice}
                    onChange={(e) => setBuyPrice(e.target.value)}
                    required
                  />
                </div>

                <div>
                  <label className="block text-gray-700 font-medium mb-2">Data zakupu</label>
                  <input
                    type="date"
                    className="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                    value={buyDate}
                    onChange={(e) => setBuyDate(e.target.value)}
                    required
                  />
                </div>
              </div>

              <div className="flex justify-between items-center">
                {selectedStock && quantity && buyPrice && (
                  <div className="text-gray-700">
                    <p className="font-medium">Wartość: {safeToFixed(parseFloat(quantity) * parseFloat(buyPrice))} PLN</p>
                  </div>
                )}

                <div className="flex space-x-4">
                  <button
                    type="button"
                    onClick={onClose}
                    className="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md font-medium"
                  >
                    Anuluj
                  </button>

                  <button
                    type="submit"
                    className="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-md font-medium"
                  >
                    Dodaj do Portfolio
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      );
    }

    // Komponent modalu dodawania nowego tickera
    function AddTickerModal({ onClose, onAddTicker }) {
      const [ticker, setTicker] = useState('');
      const [isChecking, setIsChecking] = useState(false);
      const [tickerError, setTickerError] = useState('');
      const [suggestedFullTicker, setSuggestedFullTicker] = useState('');
      const modalRef = useRef(null);

      // Obsługa kliknięcia poza modalem
      useEffect(() => {
        const handleClickOutside = (event) => {
          if (modalRef.current && !modalRef.current.contains(event.target)) {
            onClose();
          }
        };

        document.addEventListener('mousedown', handleClickOutside);
        return () => {
          document.removeEventListener('mousedown', handleClickOutside);
        };
      }, [onClose]);

      // Sprawdzanie czy ticker istnieje
      const checkTicker = async () => {
        if (!ticker) {
          setTickerError('Wprowadź symbol tickera');
          return;
        }

        setIsChecking(true);
        setTickerError('');

        try {
          const response = await fetch(`http://localhost:5000/api/check-ticker/${ticker}`);
          const data = await response.json();

          if (data.exists) {
            setSuggestedFullTicker(data.suggestedFullTicker);
          } else {
            setTickerError('Ticker nie został znaleziony. Sprawdź poprawność symbolu.');
          }
        } catch (error) {
          console.error('Błąd sprawdzania tickera:', error);
          setTickerError('Błąd podczas sprawdzania tickera. Sprawdź połączenie z serwerem.');
        } finally {
          setIsChecking(false);
        }
      };

      // Obsługa dodania tickera
      const handleAddTicker = async () => {
        if (!ticker || !suggestedFullTicker) {
          setTickerError('Sprawdź poprawność tickera przed dodaniem');
          return;
        }

        try {
          const response = await fetch('http://localhost:5000/api/tickers', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              ticker: ticker.toUpperCase(),
              fullTicker: suggestedFullTicker
            }),
          });

          if (response.ok) {
            onAddTicker();
            onClose();
          } else {
            const data = await response.json();
            setTickerError(data.error || 'Błąd podczas dodawania tickera');
          }
        } catch (error) {
          console.error('Błąd dodawania tickera:', error);
          setTickerError('Błąd podczas dodawania tickera. Sprawdź połączenie z serwerem.');
        }
      };

      return (
        <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
          <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-md">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-2xl font-bold text-gray-800">Dodaj nowy ticker do śledzenia</h2>
              <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                <i className="fas fa-times text-xl"></i>
              </button>
            </div>

            <div className="mb-6">
              <label className="block text-gray-700 font-medium mb-2">Symbol tickera</label>
              <div className="flex space-x-2">
                <input
                  type="text"
                  value={ticker}
                  onChange={(e) => setTicker(e.target.value.toUpperCase())}
                  placeholder="np. PKO, AAPL"
                  className="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <button
                  onClick={checkTicker}
                  disabled={isChecking}
                  className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md"
                >
                  {isChecking ? <i className="fas fa-spinner fa-spin"></i> : 'Sprawdź'}
                </button>
              </div>
              {tickerError && <p className="text-red-600 text-sm mt-1">{tickerError}</p>}
            </div>

            {suggestedFullTicker && (
              <div className="bg-green-100 border border-green-400 rounded-md p-4 mb-6">
                <p className="text-green-800">
                  <i className="fas fa-check-circle mr-2"></i>
                  Ticker dostępny! Pełny symbol: <strong>{suggestedFullTicker}</strong>
                </p>
              </div>
            )}

            <div className="flex justify-end space-x-4">
              <button
                onClick={onClose}
                className="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md"
              >
                Anuluj
              </button>
              <button
                onClick={handleAddTicker}
                disabled={!suggestedFullTicker || isChecking}
                className={`px-6 py-2 rounded-md font-medium ${
                  suggestedFullTicker ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                }`}
              >
                Dodaj ticker
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Komponent listy śledzonych tickerów
    function TickerManagementModal({ onClose, onRefresh }) {
      const [tickers, setTickers] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [showAddTickerModal, setShowAddTickerModal] = useState(false);
      const modalRef = useRef(null);

      // Pobierz listę śledzonych tickerów
      const fetchTickers = async () => {
        setLoading(true);
        try {
          const response = await fetch('http://localhost:5000/api/tickers');
          if (!response.ok) {
            throw new Error('Problem z pobraniem danych');
          }
          const data = await response.json();
          setTickers(data);
          setError(null);
        } catch (err) {
          console.error('Błąd pobierania tickerów:', err);
          setError('Nie udało się pobrać listy śledzonych tickerów. Sprawdź połączenie z serwerem.');
          setTickers([]);
        } finally {
          setLoading(false);
        }
      };

      // Pobierz tickery przy otwarciu modalu
      useEffect(() => {
        fetchTickers();

        // Obsługa kliknięcia poza modalem
        const handleClickOutside = (event) => {
          if (modalRef.current && !modalRef.current.contains(event.target)) {
            onClose();
          }
        };

        document.addEventListener('mousedown', handleClickOutside);
        return () => {
          document.removeEventListener('mousedown', handleClickOutside);
        };
      }, [onClose]);

      // Usuń ticker z śledzenia
      const handleRemoveTicker = async (ticker) => {
        if (confirm(`Czy na pewno chcesz usunąć ${ticker} z listy śledzonych?`)) {
          try {
            const response = await fetch(`http://localhost:5000/api/tickers/${ticker}`, {
              method: 'DELETE'
            });

            if (response.ok) {
              fetchTickers();
              onRefresh();
            } else {
              const data = await response.json();
              alert(data.error || 'Błąd podczas usuwania tickera');
            }
          } catch (error) {
            console.error('Błąd usuwania tickera:', error);
            alert('Błąd podczas usuwania tickera. Sprawdź połączenie z serwerem.');
          }
        }
      };

      // Obsługa dodania nowego tickera
      const handleTickerAdded = () => {
        fetchTickers();
        onRefresh();
      };

      return (
        <div className="fixed inset-0 flex items-center justify-center z-50 modal-background">
          <div ref={modalRef} className="bg-white rounded-lg p-8 shadow-xl w-full max-w-2xl h-auto max-h-[90vh] overflow-auto">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-2xl font-bold text-gray-800">Zarządzanie śledzonymi tickerami</h2>
              <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                <i className="fas fa-times text-xl"></i>
              </button>
            </div>

            <div className="mb-6">
              <button
                className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md font-medium flex items-center"
                onClick={() => setShowAddTickerModal(true)}
              >
                <i className="fas fa-plus mr-2"></i>
                Dodaj nowy ticker
              </button>
            </div>

            {loading ? (
              <div className="flex justify-center py-12">
                <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
              </div>
            ) : error ? (
              <div className="text-red-600 p-4 bg-red-100 rounded-md">
                <p>{error}</p>
              </div>
            ) : tickers.length === 0 ? (
              <div className="text-center py-6 bg-gray-100 rounded-md">
                <p className="text-gray-600">Brak śledzonych tickerów. Dodaj ticker, aby rozpocząć.</p>
              </div>
            ) : (
              <div className="overflow-x-auto rounded-lg shadow">
                <table className="min-w-full bg-white">
                  <thead className="bg-gray-100">
                    <tr>
                      <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Symbol</th>
                      <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Pełny symbol</th>
                      <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Status</th>
                      <th className="py-3 px-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Akcje</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {tickers.map(ticker => (
                      <tr key={ticker.id}>
                        <td className="py-4 px-4 text-sm font-medium text-gray-900">{ticker.ticker}</td>
                        <td className="py-4 px-4 text-sm text-gray-600">{ticker.full_ticker}</td>
                        <td className="py-4 px-4 text-sm">
                          {ticker.is_active ? (
                            <span className="bg-green-100 text-green-800 py-1 px-2 rounded-full text-xs font-medium">
                              Aktywny
                            </span>
                          ) : (
                            <span className="bg-gray-100 text-gray-800 py-1 px-2 rounded-full text-xs font-medium">
                              Nieaktywny
                            </span>
                          )}
                        </td>
                        <td className="py-4 px-4 text-sm">
                          {ticker.is_active && (
                            <button
                              className="text-red-600 hover:text-red-800"
                              onClick={() => handleRemoveTicker(ticker.ticker)}
                            >
                              <i className="fas fa-trash"></i>
                            </button>
                          )}
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            )}

            {showAddTickerModal && (
              <AddTickerModal
                onClose={() => setShowAddTickerModal(false)}
                onAddTicker={handleTickerAdded}
              />
            )}
          </div>
        </div>
      );
    }

  const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);


  </script>
</body>
</html>